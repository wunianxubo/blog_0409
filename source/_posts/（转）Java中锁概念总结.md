---
title: （转）Java中锁概念总结  
date: 2017-09-30 10:41:04  
tags: [java,java并发]    
categories: java  
---
原文链接：http://www.jianshu.com/p/4a8415140406
## 公平锁和非公平锁
**公平锁**：多个线程申请获取同一个锁，按照线程的申请顺序，排队获取锁。公平锁的好处是等待的线程不会被饿死，相应的缺陷就是整体吞吐量很低、效率很低。使用new ReentrantLock(true)可以构造一个公平锁。  
**非公平锁**：多个线程申请获取同一个锁，获取锁的顺序不按照申请顺序，抢占式的获取。非公平锁的好处是整体效率很高，但是可能会使有些线程一致在等待，造成饿死。使用Synchronized、new ReentrantLock()和new ReentrantLock(false)可以构建一个非公平锁。  
<!-- more -->
## 共享锁和独占锁
**共享锁**：简单的理解就是锁可以被多个线程持有。在实际使用过程中，线程A获取到了共享资源D的共享锁，其它线程只能获取D的共享锁，不能获取独占锁。  
**独占锁**：一次只能有一个线程获得锁，即只能被一个线程持有。在实际使用过程中，线程A获取到了共享资源D的独占锁，其它线程不能获取D的任何类型锁。  
## 读写锁
**读写锁**一次只有一个线程（writer线程）可以修改共享数据，但在许多情况下，任何数量的线程可以同时读取共享数据（reader线程）。Java中的读写锁通过ReentrantReadWriteLock实现。ReentrantReadWriteLock.ReadLock是读锁，它是共享锁。ReentrantReadWriteLock.WriteLock是写锁，它是独占锁。  
## 互斥锁
**互斥锁**即一次只能有一个线程持有的锁。ReentrantLock和synchronized都是互斥锁。  
## 悲观锁和乐观锁
**悲观锁**认为对同一数据的并发操作一定会出现冲突问题，所以，在对数据操作之前一定要加锁。Java编码中悲观锁的实现有很多种，for update就是一种。  
**乐观锁**认为对同一数据的并发操作不会出现冲突问题，数据操作不加锁，会在操作提交时检查数据的完整性。Java中常用的乐观锁方式有版本号、时间戳。  
## 偏向锁、轻量级锁、重量级锁
**偏向锁**：对于一段同步代码来说，锁偏向于第一次获取它的线程，如果继续执行的过程中，锁没有被其它线程持有，则持有偏向锁的线程将不需要同步，自动获取锁。  
**轻量级锁**：当偏向锁被另一个线程持有的时候，偏向锁升级为轻量级锁，其它线程通过自旋转的方式尝试获取锁。  
**重量级锁**：当轻量级锁被另一个线程持有的时候，轻量级锁升级为重量级锁。  
## 自旋锁
Java线程在得不到锁时不会立即阻塞，而是执行一个循环，不断的去尝试获取锁，这种技术就是**自旋锁**。它可以减少在获取锁的过程中，因为线程上下文的切换而导致的额外消耗。  
## 可重入锁
**可重入锁**，也称为递归锁，即线程在获取到某方法的锁之后，如果在该方法内部调用其它方法，这个方法也需要获取锁，那么进入这个方法将自动获取锁，它可以在一定程度上避免死锁。  